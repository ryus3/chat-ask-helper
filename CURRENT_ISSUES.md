# المشاكل الموجودة في النظام الحالي

## 1. نظام المعرفات (IDs)

### المشكلة:
- يوجد أكثر من نظام ID: `user_id` (UUID), `employee_id`, `small_id`, `auth_uuid`
- عدم توحيد في الاستخدام عبر الجداول
- تعقيد في الربط بين البيانات

### الأثر:
- صعوبة في جلب البيانات المترابطة
- أخطاء في الربط بين الجداول
- تعقيد في الكود

## 2. تشتت البيانات

### المشكلة:
- contexts متعددة لكل نوع بيانات
- عدم وجود cache موحد
- تكرار في استدعاء البيانات

### المواقع المتأثرة:
- `src/contexts/InventoryContext.jsx`
- `src/contexts/VariantsContext.jsx`
- `src/contexts/ProfitsContext.jsx`
- `src/contexts/AlWaseetContext.jsx`

## 3. عدم كفاءة الأداء

### المشكلة:
- كل صفحة تستدعي البيانات منفصلة
- عدم وجود lazy loading
- استدعاءات API متكررة

### الصفحات المتأثرة:
- Dashboard - يستدعي جميع البيانات
- Products - يستدعي المنتجات والمتغيرات
- Orders - يستدعي الطلبات والعملاء
- Inventory - يستدعي المخزون والمنتجات

## 4. صلاحيات معقدة

### المشكلة:
- نظام صلاحيات متعدد الطبقات
- عدم وضوح في مستويات الوصول
- تعقيد في فلترة البيانات

### الملفات المتأثرة:
- `src/hooks/useUnifiedPermissions.js`
- `src/hooks/usePermissions.js`
- `src/lib/permissions.js`

## 5. عدم ترابط الصفحات

### المشكلة:
- كل صفحة معزولة
- عدم مشاركة الحالة
- تحديث غير متسق

### أمثلة:
- إضافة منتج لا يحدث Dashboard
- تحديث طلب لا يحدث قائمة الطلبات
- تغيير مخزون لا يحدث إنذارات المخزون

## 6. مشاكل في بناء المشروع

### المشكلة الحالية:
```
sh: 1: vite: not found
```

### السبب:
- عدم تثبيت vite بشكل صحيح
- مشاكل في dependencies

## 7. عدم وجود نظام موحد للأخطاء

### المشكلة:
- كل context يتعامل مع الأخطاء منفصل
- عدم وجود error boundary موحد
- صعوبة في تتبع المشاكل

## 8. عدم كفاءة في إدارة الحالة

### المشكلة:
- استخدام useState محلي كثير
- عدم وجود global state management
- تعقيد في مشاركة البيانات

## 9. مشاكل في الـ UI/UX

### المشكلة:
- loading states غير متسقة
- عدم وجود skeleton loading
- تجربة مستخدم متقطعة

## 10. قاعدة البيانات غير مربوطة

### المشكلة:
- المشروع لا يحتوي على جداول حقيقية
- البيانات محلية أو mock data
- عدم وجود integration حقيقي مع Supabase

## الحلول المطلوبة:

1. **توحيد نظام IDs** - استخدام UUID واحد فقط
2. **إنشاء UnifiedDataProvider** - لإدارة جميع البيانات
3. **استخدام React Query** - للتخزين المؤقت والأداء
4. **تبسيط نظام الصلاحيات** - هيكل واضح ومنطقي
5. **ربط قاعدة البيانات** - إنشاء الجداول الحقيقية
6. **تحسين UX** - loading states وerror handling موحد
7. **إصلاح البناء** - حل مشاكل dependencies